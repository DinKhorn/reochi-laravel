(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{1071:function(t,e,o){"use strict";o.r(e);o(35),o(39),o(15);var n=o(2),r=o(529);n.default.filter("formatMoney",(function(t){return r(t).format("0,0.00")}));var l={name:"EditSale",created:function(){this.fetchProduct(),this.fetchSale(),this.fetchMember(),this.fetchLocation()},data:function(){return{form:{products:[],discount:0,paid:0,shipping_cost:0},items:[],payment_status:["Paid","Due"],payment_method:["Cash","Cheque"],sale_status:["Completed","Pending"],members:[],locations:[],products:[],sales:[]}},computed:{calculateQty:function(){return this.form.products.reduce((function(t,e){return t+e.quantity}),0)},Total:function(){return this.form.products.reduce((function(t,e){return t+Number(e.unit_price*e.quantity)}),0)},grandTotal:function(){var t=this;return this.form.products.reduce((function(e,o){return e+(o.unit_price-o.unit_price*t.form.discount/100)*o.quantity+Number(t.form.shipping_cost)}),0)}},methods:{fetchSale:function(){var t=this;this.$axios.$get("api/sale/"+this.$route.params.id).then((function(e){for(var i in t.$set(t.$data,"form",e.sales),t.form.products)n.default.set(t.form.products[i],"quantity",t.form.products[i].pivot.quantity),n.default.set(t.form.products[i],"unit_price",t.form.products[i].pivot.unit_price),n.default.set(t.form.products[i],"discount",t.form.products[i].pivot.discount);console.log(e)})).catch((function(t){console.log(t.response)}))},fetchLocation:function(){var t=this;this.$axios.$get("api/location").then((function(e){t.locations=e.locations.data,console.log(e)})).catch((function(t){console.log(t.response)}))},fetchMember:function(){var t=this;this.$axios.$get("api/member").then((function(e){t.members=e.members.data})).catch((function(t){console.log(t.response)}))},fetchProduct:function(){var t=this;this.$axios.$get("api/product").then((function(e){t.$set(t.$data,"products",e.products.data),console.log(e)})).catch((function(t){console.log(t.response)}))},updateSale:function(){var t=this;this.$axios.$patch("api/sale/"+this.form.id,{paid:this.form.paid,payment_status:this.form.payment_status,payment_method:this.form.payment_method,branch:this.form.branch,member:this.form.member,products:this.form.products,discount:this.form.discount}).then((function(e){t.$set(t.$data,"sales",e.data),console.log(e),t.$router.push("/sale/sale-list")})).catch((function(t){console.log(t.response)}))},addTocart:function(t){this.form.products.includes(t)?n.default.set(t,"quantity",t.quantity+=1):(this.form.products.push(t),n.default.set(t,"unit_price",t.price),n.default.set(t,"quantity",1),n.default.set(t,"discount",0)),console.log(this.form.products),console.log(t)},removeItem:function(t){this.form.products.splice(t,1)},discountedPrice:function(t){return t.unit_price*t.quantity}}},c=(o(907),o(31)),d=o(102),m=o.n(d),f=o(538),v=o(167),h=o(147),_=o(66),x=o(393),y=o(541),C=o(372),T=o(143),$=o(396),w=o(537),S=o(369),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("v-card",[o("div",{staticClass:"indigo lighten-1 white--text"},[o("v-card-title",[t._v("Edit Sale")])],1),t._v(" "),o("v-divider"),t._v(" "),o("div",{staticClass:"px-5"},[o("p",{staticClass:"caption font-italic pt-5"},[t._v("The field labels marked with * are required input fields.")]),t._v(" "),o("v-row",[o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold"},[t._v("Customer*")]),t._v(" "),o("v-autocomplete",{attrs:{solo:"",outlined:"",dense:"",label:"Select Customer",items:t.members,"item-value":"name","item-text":"name","return-object":""},model:{value:t.form.member,callback:function(e){t.$set(t.form,"member",e)},expression:"form.member"}})],1),t._v(" "),o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold"},[t._v("Warehouse*")]),t._v(" "),o("v-autocomplete",{attrs:{solo:"",outlined:"",dense:"",label:"Select Warehouse",items:t.locations,"item-value":"name","item-text":"name","return-object":""},model:{value:t.form.branch,callback:function(e){t.$set(t.form,"branch",e)},expression:"form.branch"}})],1),t._v(" "),o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold"},[t._v("Payment Method*")]),t._v(" "),o("v-select",{attrs:{solo:"",outlined:"",dense:"",items:t.payment_method,label:"Please Select"},model:{value:t.form.payment_method,callback:function(e){t.$set(t.form,"payment_method",e)},expression:"form.payment_method"}})],1),t._v(" "),o("v-col",{attrs:{md:"12",cols:"12"}},[o("label",{staticClass:"font-weight-bold"},[t._v("Select Product")]),t._v(" "),o("v-autocomplete",{attrs:{solo:"",outlined:"",dense:"","append-icon":"mdi-barcode",items:t.products,"item-value":"name","item-text":"name","return-object":""},on:{input:t.addTocart}})],1)],1),t._v(" "),o("div",[o("table",{staticClass:"saleTable"},[o("thead",[o("tr",[o("th",{staticClass:"saleTable--th"},[t._v("Name")]),t._v(" "),o("th",{staticClass:"saleTable--th"},[t._v("Code")]),t._v(" "),o("th",{staticClass:"saleTable--th"},[t._v("Quantity")]),t._v(" "),o("th",{staticClass:"saleTable--th"},[t._v("Product Price")]),t._v(" "),o("th",{staticClass:"saleTable--th"},[t._v("Total")]),t._v(" "),o("th",{staticClass:"saleTable--th"},[t._v("Action")])])]),t._v(" "),o("tbody",[t._l(t.form.products,(function(e,n){return o("tr",{key:n,staticClass:"saleTable--td"},[o("td",[t._v(t._s(e.name))]),t._v(" "),o("td",[t._v(t._s(e.code))]),t._v(" "),o("td",[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.products[n].quantity,expression:"form.products[index].quantity",modifiers:{number:!0}}],staticClass:"saleTable--input",attrs:{type:"number"},domProps:{value:t.form.products[n].quantity},on:{input:function(e){e.target.composing||t.$set(t.form.products[n],"quantity",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),o("td",[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.products[n].unit_price,expression:"form.products[index].unit_price",modifiers:{number:!0}}],staticClass:"saleTable--input",attrs:{type:"number",placeholder:"0.00"},domProps:{value:t.form.products[n].unit_price},on:{input:function(e){e.target.composing||t.$set(t.form.products[n],"unit_price",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),o("td",[t._v("USD "+t._s(t._f("formatMoney")(t.discountedPrice(e))))]),t._v(" "),o("td",[o("v-btn",{attrs:{small:"",color:"red",outlined:""},on:{click:function(e){return t.removeItem(n)}}},[o("v-icon",[t._v("mdi-delete")])],1)],1)])})),t._v(" "),o("tr",{staticClass:"saleTable--total"},[o("th",{attrs:{colspan:"2"}},[t._v("Total")]),t._v(" "),o("td",{attrs:{colspan:"2"}},[t._v(t._s(t.calculateQty))]),t._v(" "),o("td",[t._v("USD "+t._s(t._f("formatMoney")(t.Total)))])])],2)])]),t._v(" "),o("v-row",[o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold",attrs:{for:""}},[t._v("Shipping Cost")]),t._v(" "),o("v-text-field",{attrs:{solo:"",outlined:"",dense:"",type:"number",placeholder:"0.0"},model:{value:t.form.shipping_cost,callback:function(e){t.$set(t.form,"shipping_cost",e)},expression:"form.shipping_cost"}})],1),t._v(" "),o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold",attrs:{for:""}},[t._v("Paid")]),t._v(" "),o("v-text-field",{attrs:{solo:"",outlined:"",dense:"",type:"number",placeholder:"0.0"},model:{value:t.form.paid,callback:function(e){t.$set(t.form,"paid",e)},expression:"form.paid"}})],1),t._v(" "),o("v-col",{attrs:{md:"4",cols:"12"}},[o("label",{staticClass:"font-weight-bold",attrs:{for:"discount"}},[t._v("Discount Percent")]),t._v(" "),o("v-text-field",{attrs:{solo:"",outlined:"",dense:""},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1)],1),t._v(" "),o("div",{staticClass:"d-flex justify-space-between grandTotal px-5 py-2"},[o("div",{staticClass:"granTotal--border"},[o("span",{staticClass:"font-weight-medium"},[t._v("Item:")]),t._v(" "),o("span",[t._v(t._s(t.calculateQty))])]),t._v(" "),o("div",[o("span",{staticClass:"font-weight-medium"},[t._v("Total:")]),t._v(" "),o("span",[t._v("USD "+t._s(t.Total))])]),t._v(" "),o("div",[o("span",{staticClass:"font-weight-medium"},[t._v("Grand Total:")]),t._v(" "),o("span",[t._v("USD "+t._s(t.grandTotal))])])]),t._v(" "),o("div",{staticClass:"d-flex flex-column pt-5"},[o("label",{attrs:{for:"note"}},[t._v("Note")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.description,expression:"form.description"}],staticClass:"sale--textarea",attrs:{cols:"30",rows:"5"},domProps:{value:t.form.description},on:{input:function(e){e.target.composing||t.$set(t.form,"description",e.target.value)}}})])],1),t._v(" "),o("v-btn",{directives:[{name:"permission",rawName:"v-permission",value:"add sales",expression:"'add sales'"}],staticClass:"blue mx-5 lighten-2 my-5",on:{click:t.updateSale}},[o("v-icon",[t._v("mdi-check")]),t._v("Submit\n\t\t")],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;m()(component,{VAutocomplete:f.a,VBtn:v.a,VCard:h.a,VCardTitle:_.c,VCol:x.a,VContainer:y.a,VDivider:C.a,VIcon:T.a,VRow:$.a,VSelect:w.a,VTextField:S.a})},673:function(t,e,o){var content=o(908);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(12).default)("2fbb9824",content,!0,{sourceMap:!1})},907:function(t,e,o){"use strict";var n=o(673);o.n(n).a},908:function(t,e,o){(t.exports=o(11)(!1)).push([t.i,".sale--textarea{border:1px solid #349feb;outline:none}.saleTable{border-collapse:collapse;width:100%}.saleTable--th{border-bottom:1px solid rgba(0,0,0,.125);text-align:left;padding-bottom:2px}.saleTable--input{border:1px solid rgba(0,0,0,.125);padding:5px;margin:10px auto;outline:none}.saleTable--total{font-weight:400;text-align:left;padding-top:10px}.saleTable--td{border-bottom:1px solid rgba(0,0,0,.125)}.grandTotal{border:1px solid rgba(27,3,3,.125)}.grandTotal--border{border-right:1px solid rgba(27,3,3,.125)}",""])}}]);